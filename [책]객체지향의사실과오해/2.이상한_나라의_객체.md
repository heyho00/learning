# 이상한 나라의 객체

`객체지향 패러다임은 지식을 추상화하고 추상화한 지식을 객체 안에 캡슐화함으로써 실세계 문제에 내재된 복잡성을 관리하려고 한다.` 객체를 발견하고 창조하는 것은 지식과 행동을 구조화하는 문제다.

- Rebecca Wirfs-Brock

 <br>

**객체란 식별 가능한 개체 또는 사물이다.** 객체는 자동차처럼 만질 수 있는 구체적인 사물일 수도 있고, 시간처럼 추상적인 개념일 수도 있다. 객체는 구별 가능한 식별자, 특징적인 행동，변경 가능한 상태를 가진다. 소프트웨어 안에서 객체는 저장된 상태와 실행 가능한 코드를 통해 구현된다.

<br>

## 📍 상태

인간은 행동의 과정과 결과를 단순하게 기술하기 위해 상태라는 개념을 고안했다.

비행기 탑승 가능 여부는 항공권의 발권 상태를 보고 예측할 수 있다. 자판기는 현재까지 투입된 금액의 상태를 기억한다. 텔레비전 전원이 들어온 상태여야만 채널을 변경할 수 있다.

세상에 존재하는 모든 것들이 객체인 것은 아니다.
분명하게 인식할 수 있음에도 객체의 영역에 포함시킬 수 없는 것들도 있다.

앨리스의 키와 위치는 객체가 아니다.

숫자, 문자열，양, 속도，시간, 날짜, 참/거짓과 같은 단순한 값들은 객체가 아니다. 단순한 값들은 **그 자체로 독립적인 의미를 가지기보다는 다른 객체의 특성을 표현하는 데 사용된다.** 다시 말해 다른 객체의 상태를 표현하기 위해 사용된다.
이때 객 체의 상태를 구성하는 모든 특징을 통틀어 **객체의 프로퍼티**(property)라고 한다.

객체는 자율적인 존재이며 다른 객체의 상태에 직접 접근할수도, 상태를 변경할 수도 없다. 자율적인 객체는 스스로 자신의 상태를 책임진다.
이 시점에 행동이 등장한다.
**행동은 다른 객체로 하여금 간접적으로 객체의 상태를 변경하는 것을 가능하게 한다.**

<br>

## 📍 행동

객체의 상태는 저절로 변경되지 않는다. 객체의 상태를 변경하는 것은 객체의 자발적인 행동뿐이다. 앨리스의 키가 작아진 이유는 앨리스가 음료를 마셨기 때문이다. 앨리스의 위치가 통로에서 정원으로 바뀐 이유는 앨리스가 문을 통과했기 때문이다. 앨리스가 특정한 행동을 취할 때마다 앨리스의 키와 위치는 변경된다.

객체가 취하는 행동은 객체 자신의 상태를 변경시킨다. 객체의 행동에 의해 객체의 상태가 변경된다는 것은 행동이 **부수 효과(side effect)** 를 초래한다는 것을 의미한다.

객체의 행동은 객체의 상태를 변경시키지만 행동의 결과는 객체의 상태에 의존적이다. 음료를 마신 후의 앨리스의 키는 음료를 마시기 전의 앨리스의 키보다 작아져야 한다. 이것은 음료률 마시는 행동의 결과가 앨리스의 키에 의존한다는 것을 의미한다.

■ 객체의 행동은 상태에 영향을 받는다.
■ 객체의 행동은 상태를 변경시킨다.

앨리스가 통과해야 하는 문의 크기가 40센티미터라고 가정하면 문을 통과하는 행동은 과거의 행동을 돌아볼 필요없이 앨리스의 ‘키’와 ‘위치’라는 두 가지 상태를 이용해 간단하게 서술할 수 있다.

■ 앨리스의 키가 40센티미터 이하라면 문을 통과할 수 있다.
■ 문을 통과한 후에 앨리스의 위치는 아름다운 정원으로 바뀌어야 한다.

<br>

## 📍 상태 캡슐화

현실 세계의 객체와 객체지향 세계의 객체 사이에는 중요한 차이점이 있다. 현실 속에서 앨리스는 스스로 음료를 마시는 능동적인 존재지만 음료는 스스로는 아무것도 할 수 없는 수동적인 존재다.
현실 세계라면 음료의 양을 줄여 상태를 변경시키는 주체는 음료를 목 안으로 밀어넣은 앨리스가 될 것이다.

그러나 객체지향의 세계에서 모든 객체는 자신의 상태를 스스로 관리하는 자율적인 존재다. 앨리스 객체의 키를 작게 만드는 것이 앨리스 자신인 것처럼 음료 객체의 양을 줄이는 것은 음료 자신이어야 한다. 따라서 앨리스는 직접적으로 음료의 상태를 변경 할 수 없다. 단지 음료에게 자신이 음료를 마셨다는 메시지를 전달할 수 있을 뿐이다. 적절한 정도로 음료의 양을 줄이는 것은 메시지를 전달받은 음료 스스로의 몫이다.

앨리스에게 전달되는 메시지는 drinkBeverage()이고 음료에게 전달되는 메시지는 drunken(quantity)다. 두 메시지를 보고 앨리스의 키가 줄어든다거나 음료의 양이 줄어든다는 상태 변경을 예상할 수 있겠는가? 메시지를 앨리스에게 전송하는 객체이건 음료에게 메시지를 전송하는 앨리스 객체이건 메시지 송신자는 메시지 수신자의 상태 변경에 대해서는 전혀 알지 못한다.

이것이 캡슐화. **객체는 상태를 캡술 안에 감춰둔 채 외부로 노출하지 않는다. 객체가 외부에 노출하는 것은 행동뿐이며，외부에서 객체에 접근할 수 있는 유일한 방법 역시 행동뿐이다.**

상태를 외부에 노출시키지 않고 행동을 경계로 캡술화하는것은 결과적으로 객체의 자율성을 높인다. 자율적인 객체는 스스로 판단하고 스스로 결정하기 때문에 객체의 자율성이 높아질수록 객체의 지능도 높아진다. 협력에 참여하는 객체들의 지능이 높아질 수록 협력은 유연하고 간결해진다.

**결론적으로 상태를 잘 정의된 행동 집합 뒤로 캡슐화하는 것은 객체의 자율성을 높이고 협력을 단순하고 유연하게 만든다. 이것이 상태를 캡슐화해야 하는 이유다.**

<br>

## 기계로서의 객체

개발자들의 주된 업무는 객체의 상태를 조회하고 객체의 상태를 변경하는 것이다. 일반적으로 객체의 상태를 조회하는 작업을 쿼리(query)라고 하고 객체의 상태를 변경하는 작업을 명령(command)이라고 한다.

- 기계는 단단한 금속 외피로 감춰져 있기 때문에 기계를 분해하지 않으면 내부를 직접 볼 수 없다.

- 사람은 기계 외부에 부착된 버튼을 이용해서만 기계와 상호작용할 수 있다.

- 사각형 버튼을 누른 시점에 변경된 상태를 직접 눈으로 볼 수는 없다. 대신 원하는 시점에 원 모양의 버튼을 눌러 객체의 상태를 조회할 수는 있다.

- 객체의 상태는 상단의 디스플레이 창에 출력된다.

- 중요한 것은 명령 버튼과 쿼리 버튼 이외의 다른 방법을 통해서는 앨리스 기계를 사용할 수 없다는 것이다. 사용자는 기계를 열어 기계 내부의 상태에 직접 접근하려고 하지 않는다.

- 사용자는 객체가 제공하는 명령 버튼과 쿼리 버튼으로 구성된 인터페이스를 통해서만 객체에 접근할 수 있다.

- 외부에 동일한 행동을 제공하고 상태가 동잃한 두 기계가 있어도 사람은 구분된 두 기계로 인식한다. 이것은 객체가 상태와 무관하게 구분 가능한 식별자를 가진다는 것을 의미한다.

- 객체지향 패러다임 관점에서 이것은 ‘음료를 마시다’라는 메시지를 수신한 앨리스 객체가 메시지를 처리하던 도중 음료 객체에게 ‘마셔지다’라는 메시지를 전송한 것과 동일하다. 즉，링크를 통해 연결된 두 객체가 메시지 전송을 통해 협력하고 있는 것이다.

<br>

## 행동이 상태를 결정한다.

상태를 먼저 결정하고 행동을 나중에 결정하는 방법은 설계에 나쁜 영향을 끼친다.

1. 상태를 먼저 결정할 경우 캡슐화가 저해된다. 상태에 초점을 맞출 경우 상태가 객체 내부로 깔끔하게 캡술화되지 못하고 공용 인터페이스에 그대로 노출될 확률이 높아진다.

2. 객체를 협력자가 아닌 고립된 섬으로 만든다. 객체가 필요한 이유는 애플리케이션의 문맥 내에서 다른 객체와 협력하기 위해서다. 불행하게도 상태를 먼저 고려하는 방식은 협력이라는 문맥에서 멀리 벗어난 채 객체를 설계하게 함으로써 자연스럽게 협력에 적합하지 못한 객체를 창조하게 된다.

3. 객체의 재사용성이 저하된다. 객체의 재사용성은 다양한 협력에 참여할 수 있는 능력에서 나온다. 상태에 초점을 맞춘 객체는 다양한 협력에 참여하기 어렵기 때문에 재사용성이 저하될 수밖에 없다.

어떤 책임이 필요한가를 결정하는 과정이 전체 설계를 주도해야 한다. 이 책에서 살펴볼 **책임-주도 설계(Responsibility-Driven Design, RDD)**[Wirfs~ Brock 2003]는 협력이라는 문맥 안에서 객체의 행동을 생각하도록 도음으로써 응집도 높고 재사용 가능한 객체를 만들 수 있게 한다.

<br>

## 은유와 객체

흔히 객체지향을 현실 세계의 추상화라고도 하는데，그 안에는 현실 세계를 모방해서 단순화한다는 의미가 숨어 있다. 여기서 **추상화{abstraction)**란 실제의 사물에서 자신이 원하는 특성만 취하고 필요 없는 부분을 추려 핵심만 표현하는 행위를 말한다.

그러나 객체지향 세계는 현실 세계의 단순한 모방이 아니다.

<br>

## 의인화

그렇다면 현실 속의 객체와 소프트웨어 객체 사이의 가장 큰 차이점은 무엇일까? 그것은 현실 속에서는 수동적인 존재가 소프트웨어 객체로 구현될 때는 능동적으로 변한다는 것이다.

<br>

## 은유

현실 세계와 객체지향 세계 사이의 관계를 좀 더 정확하게 설명할 수 있는 단어는 은유(metaphor)다[Noble 2002].
